<!DOCTYPE html>  <html> <head>   <title>ListMorph.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="BlinkerMorph.html">                 BlinkerMorph.coffee               </a>                                           <a class="source" href="BouncerMorph.html">                 BouncerMorph.coffee               </a>                                           <a class="source" href="BoxMorph.html">                 BoxMorph.coffee               </a>                                           <a class="source" href="CaretMorph.html">                 CaretMorph.coffee               </a>                                           <a class="source" href="CircleBoxMorph.html">                 CircleBoxMorph.coffee               </a>                                           <a class="source" href="CloseCircleButtonMorph.html">                 CloseCircleButtonMorph.coffee               </a>                                           <a class="source" href="Color.html">                 Color.coffee               </a>                                           <a class="source" href="ColorPaletteMorph.html">                 ColorPaletteMorph.coffee               </a>                                           <a class="source" href="ColorPickerMorph.html">                 ColorPickerMorph.coffee               </a>                                           <a class="source" href="FrameMorph.html">                 FrameMorph.coffee               </a>                                           <a class="source" href="GrayPaletteMorph.html">                 GrayPaletteMorph.coffee               </a>                                           <a class="source" href="HandMorph.html">                 HandMorph.coffee               </a>                                           <a class="source" href="HandleMorph.html">                 HandleMorph.coffee               </a>                                           <a class="source" href="InspectorMorph.html">                 InspectorMorph.coffee               </a>                                           <a class="source" href="ListMorph.html">                 ListMorph.coffee               </a>                                           <a class="source" href="MenuItemMorph.html">                 MenuItemMorph.coffee               </a>                                           <a class="source" href="MenuMorph.html">                 MenuMorph.coffee               </a>                                           <a class="source" href="Morph.html">                 Morph.coffee               </a>                                           <a class="source" href="MorphicNode.html">                 MorphicNode.coffee               </a>                                           <a class="source" href="MorphsListMorph.html">                 MorphsListMorph.coffee               </a>                                           <a class="source" href="MouseSensorMorph.html">                 MouseSensorMorph.coffee               </a>                                           <a class="source" href="Mousetrap.html">                 Mousetrap.coffee               </a>                                           <a class="source" href="PenMorph.html">                 PenMorph.coffee               </a>                                           <a class="source" href="Point.html">                 Point.coffee               </a>                                           <a class="source" href="Point2.html">                 Point2.coffee               </a>                                           <a class="source" href="Rectangle.html">                 Rectangle.coffee               </a>                                           <a class="source" href="RectangleMorph.html">                 RectangleMorph.coffee               </a>                                           <a class="source" href="ScrollFrameMorph.html">                 ScrollFrameMorph.coffee               </a>                                           <a class="source" href="ShadowMorph.html">                 ShadowMorph.coffee               </a>                                           <a class="source" href="SliderButtonMorph.html">                 SliderButtonMorph.coffee               </a>                                           <a class="source" href="SliderMorph.html">                 SliderMorph.coffee               </a>                                           <a class="source" href="SpeechBubbleMorph.html">                 SpeechBubbleMorph.coffee               </a>                                           <a class="source" href="StringFieldMorph.html">                 StringFieldMorph.coffee               </a>                                           <a class="source" href="StringMorph.html">                 StringMorph.coffee               </a>                                           <a class="source" href="SystemTest_SimpleMenuTest.html">                 SystemTest_SimpleMenuTest.coffee               </a>                                           <a class="source" href="SystemTestsRecorderAndPlayer.html">                 SystemTestsRecorderAndPlayer.coffee               </a>                                           <a class="source" href="TextMorph.html">                 TextMorph.coffee               </a>                                           <a class="source" href="TriggerMorph.html">                 TriggerMorph.coffee               </a>                                           <a class="source" href="WorkspaceMorph.html">                 WorkspaceMorph.coffee               </a>                                           <a class="source" href="WorldMorph.html">                 WorldMorph.coffee               </a>                                           <a class="source" href="globalFunctions.html">                 globalFunctions.coffee               </a>                                           <a class="source" href="globalSettings.html">                 globalSettings.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               ListMorph.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>ListMorph ///////////////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">ListMorph</span> <span class="k">extends</span> <span class="nx">ScrollFrameMorph</span>
  
  <span class="nv">elements: </span><span class="kc">null</span>
  <span class="nv">labelGetter: </span><span class="kc">null</span>
  <span class="nv">format: </span><span class="kc">null</span>
  <span class="nv">listContents: </span><span class="kc">null</span>
  <span class="nv">selected: </span><span class="kc">null</span> <span class="c1"># actual element currently selected</span>
  <span class="nv">active: </span><span class="kc">null</span> <span class="c1"># menu item representing the selected element</span>
  <span class="nv">action: </span><span class="kc">null</span>
  <span class="nv">doubleClickAction: </span><span class="kc">null</span>

  <span class="nv">constructor: </span><span class="nf">(@elements = [], labelGetter, @format = [], @doubleClickAction = null) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>passing a format is optional. If the format parameter is specified
   it has to be of the following pattern:</p>

<pre><code>   [
       [&lt;color&gt;, &lt;single-argument predicate&gt;],
       ['bold', &lt;single-argument predicate&gt;],
       ['italic', &lt;single-argument predicate&gt;],
       ...
   ]
</code></pre>

<p>multiple conditions can be passed in such a format list, the
   last predicate to evaluate true when given the list element sets
   the given format category (color, bold, italic).
   If no condition is met, the default format (color black, non-bold,
   non-italic) will be assigned.</p>

<p>An example of how to use fomats can be found in the InspectorMorph's
   "markOwnProperties" mechanism.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">super</span><span class="p">()</span>
    <span class="vi">@contents.acceptsDrops = </span><span class="kc">false</span>
    <span class="vi">@color = </span><span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="vi">@hBar.alpha = </span><span class="mf">0.6</span>
    <span class="vi">@vBar.alpha = </span><span class="mf">0.6</span>
    <span class="vi">@labelGetter = </span><span class="nx">labelGetter</span> <span class="o">or</span> <span class="nf">(element) -&gt;</span>
        <span class="k">return</span> <span class="nx">element</span>  <span class="k">if</span> <span class="nx">isString</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="nx">element</span><span class="p">.</span><span class="nx">toSource</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">element</span><span class="p">.</span><span class="nx">toSource</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
    <span class="nx">@buildListContents</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>it's important to leave the step as the default noOperation
instead of null because the scrollbars (inherited from scrollframe)
need the step function to react to mouse drag.</p>             </td>             <td class="code">               <div class="highlight"><pre>  
  <span class="nv">buildListContents: </span><span class="nf">-&gt;</span>
    <span class="nx">@listContents</span><span class="p">.</span><span class="nx">destroy</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">@listContents</span>
    <span class="vi">@listContents = </span><span class="k">new</span> <span class="nx">MenuMorph</span><span class="p">(</span><span class="nx">@select</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">@</span><span class="p">)</span>
    <span class="vi">@elements = </span><span class="p">[</span><span class="s">&quot;(empty)&quot;</span><span class="p">]</span>  <span class="k">if</span> <span class="o">!</span><span class="nx">@elements</span><span class="p">.</span><span class="nx">length</span>
    <span class="nx">@elements</span><span class="p">.</span><span class="nx">forEach</span> <span class="nf">(element) =&gt;</span>
      <span class="nv">color = </span><span class="kc">null</span>
      <span class="nv">bold = </span><span class="kc">false</span>
      <span class="nv">italic = </span><span class="kc">false</span>
      <span class="nx">@format</span><span class="p">.</span><span class="nx">forEach</span> <span class="nf">(pair) -&gt;</span>
        <span class="k">if</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">call</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span>
          <span class="k">if</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;bold&#39;</span>
            <span class="nv">bold = </span><span class="kc">true</span>
          <span class="k">else</span> <span class="k">if</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;italic&#39;</span>
            <span class="nv">italic = </span><span class="kc">true</span>
          <span class="k">else</span> <span class="c1"># assume it&#39;s a color</span>
            <span class="nv">color = </span><span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>label string
action
hint</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">@listContents</span><span class="p">.</span><span class="nx">addItem</span> <span class="nx">@labelGetter</span><span class="p">(</span><span class="nx">element</span><span class="p">),</span> <span class="nx">element</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">color</span><span class="p">,</span> <span class="nx">bold</span><span class="p">,</span> <span class="nx">italic</span><span class="p">,</span> <span class="nx">@doubleClickAction</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">@listContents</span><span class="p">.</span><span class="nx">setPosition</span> <span class="nx">@contents</span><span class="p">.</span><span class="nx">position</span><span class="p">()</span>
    <span class="vi">@listContents.isListContents = </span><span class="kc">true</span>
    <span class="nx">@listContents</span><span class="p">.</span><span class="nx">updateRendering</span><span class="p">()</span>
    <span class="nx">@addContents</span> <span class="nx">@listContents</span>
  
  <span class="nv">select: </span><span class="nf">(item, trigger) -&gt;</span>
    <span class="vi">@selected = </span><span class="nx">item</span>
    <span class="vi">@active = </span><span class="nx">trigger</span>
    <span class="nx">@action</span><span class="p">.</span><span class="nx">call</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">item</span>  <span class="k">if</span> <span class="nx">@action</span>
  
  <span class="nv">setExtent: </span><span class="nf">(aPoint) -&gt;</span>
    <span class="nv">lb = </span><span class="nx">@listContents</span><span class="p">.</span><span class="nx">bounds</span>
    <span class="nv">nb = </span><span class="nx">@bounds</span><span class="p">.</span><span class="nx">origin</span><span class="p">.</span><span class="nx">copy</span><span class="p">().</span><span class="nx">corner</span><span class="p">(</span><span class="nx">@bounds</span><span class="p">.</span><span class="nx">origin</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">aPoint</span><span class="p">))</span>
    <span class="k">if</span> <span class="nx">nb</span><span class="p">.</span><span class="nx">right</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">lb</span><span class="p">.</span><span class="nx">right</span><span class="p">()</span> <span class="o">and</span> <span class="nx">nb</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nx">lb</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span>
      <span class="nx">@listContents</span><span class="p">.</span><span class="nx">setRight</span> <span class="nx">nb</span><span class="p">.</span><span class="nx">right</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">nb</span><span class="p">.</span><span class="nx">bottom</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">lb</span><span class="p">.</span><span class="nx">bottom</span><span class="p">()</span> <span class="o">and</span> <span class="nx">nb</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nx">lb</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span>
      <span class="nx">@listContents</span><span class="p">.</span><span class="nx">setBottom</span> <span class="nx">nb</span><span class="p">.</span><span class="nx">bottom</span><span class="p">()</span>
    <span class="k">super</span> <span class="nx">aPoint</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 