<!DOCTYPE html>  <html> <head>   <title>SliderMorph.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="BlinkerMorph.html">                 BlinkerMorph.coffee               </a>                                           <a class="source" href="BouncerMorph.html">                 BouncerMorph.coffee               </a>                                           <a class="source" href="BoxMorph.html">                 BoxMorph.coffee               </a>                                           <a class="source" href="CaretMorph.html">                 CaretMorph.coffee               </a>                                           <a class="source" href="CircleBoxMorph.html">                 CircleBoxMorph.coffee               </a>                                           <a class="source" href="CloseCircleButtonMorph.html">                 CloseCircleButtonMorph.coffee               </a>                                           <a class="source" href="Color.html">                 Color.coffee               </a>                                           <a class="source" href="ColorPaletteMorph.html">                 ColorPaletteMorph.coffee               </a>                                           <a class="source" href="ColorPickerMorph.html">                 ColorPickerMorph.coffee               </a>                                           <a class="source" href="FrameMorph.html">                 FrameMorph.coffee               </a>                                           <a class="source" href="GrayPaletteMorph.html">                 GrayPaletteMorph.coffee               </a>                                           <a class="source" href="HandMorph.html">                 HandMorph.coffee               </a>                                           <a class="source" href="HandleMorph.html">                 HandleMorph.coffee               </a>                                           <a class="source" href="InspectorMorph.html">                 InspectorMorph.coffee               </a>                                           <a class="source" href="ListMorph.html">                 ListMorph.coffee               </a>                                           <a class="source" href="MenuItemMorph.html">                 MenuItemMorph.coffee               </a>                                           <a class="source" href="MenuMorph.html">                 MenuMorph.coffee               </a>                                           <a class="source" href="Morph.html">                 Morph.coffee               </a>                                           <a class="source" href="MorphicNode.html">                 MorphicNode.coffee               </a>                                           <a class="source" href="MorphsListMorph.html">                 MorphsListMorph.coffee               </a>                                           <a class="source" href="MouseSensorMorph.html">                 MouseSensorMorph.coffee               </a>                                           <a class="source" href="Mousetrap.html">                 Mousetrap.coffee               </a>                                           <a class="source" href="PenMorph.html">                 PenMorph.coffee               </a>                                           <a class="source" href="Point.html">                 Point.coffee               </a>                                           <a class="source" href="Point2.html">                 Point2.coffee               </a>                                           <a class="source" href="Rectangle.html">                 Rectangle.coffee               </a>                                           <a class="source" href="RectangleMorph.html">                 RectangleMorph.coffee               </a>                                           <a class="source" href="ScrollFrameMorph.html">                 ScrollFrameMorph.coffee               </a>                                           <a class="source" href="ShadowMorph.html">                 ShadowMorph.coffee               </a>                                           <a class="source" href="SliderButtonMorph.html">                 SliderButtonMorph.coffee               </a>                                           <a class="source" href="SliderMorph.html">                 SliderMorph.coffee               </a>                                           <a class="source" href="SpeechBubbleMorph.html">                 SpeechBubbleMorph.coffee               </a>                                           <a class="source" href="StringFieldMorph.html">                 StringFieldMorph.coffee               </a>                                           <a class="source" href="StringMorph.html">                 StringMorph.coffee               </a>                                           <a class="source" href="SystemTest_SimpleMenuTest.html">                 SystemTest_SimpleMenuTest.coffee               </a>                                           <a class="source" href="SystemTestsRecorderAndPlayer.html">                 SystemTestsRecorderAndPlayer.coffee               </a>                                           <a class="source" href="TextMorph.html">                 TextMorph.coffee               </a>                                           <a class="source" href="TriggerMorph.html">                 TriggerMorph.coffee               </a>                                           <a class="source" href="WorkspaceMorph.html">                 WorkspaceMorph.coffee               </a>                                           <a class="source" href="WorldMorph.html">                 WorldMorph.coffee               </a>                                           <a class="source" href="globalFunctions.html">                 globalFunctions.coffee               </a>                                           <a class="source" href="globalSettings.html">                 globalSettings.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               SliderMorph.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>SliderMorph ///////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>this comment below is needed to figure our dependencies between classes
REQUIRES globalFunctions</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">SliderMorph</span> <span class="k">extends</span> <span class="nx">CircleBoxMorph</span>

  <span class="nv">target: </span><span class="kc">null</span>
  <span class="nv">action: </span><span class="kc">null</span>
  <span class="nv">start: </span><span class="kc">null</span>
  <span class="nv">stop: </span><span class="kc">null</span>
  <span class="nv">value: </span><span class="kc">null</span>
  <span class="nv">size: </span><span class="kc">null</span>
  <span class="nv">offset: </span><span class="kc">null</span>
  <span class="nv">button: </span><span class="kc">null</span>
  <span class="nv">step: </span><span class="kc">null</span>

  <span class="nv">constructor: </span><span class="nf">(@start = 1, @stop = 100, @value = 50, @size = 10, orientation, color) -&gt;</span>
    <span class="vi">@button = </span><span class="k">new</span> <span class="nx">SliderButtonMorph</span><span class="p">()</span>
    <span class="vi">@button.isDraggable = </span><span class="kc">false</span>
    <span class="vi">@button.color = </span><span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="vi">@button.highlightColor = </span><span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">210</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="vi">@button.pressColor = </span><span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="k">super</span> <span class="nx">orientation</span> <span class="c1"># if null, then a vertical one will be created</span>
    <span class="nx">@add</span> <span class="nx">@button</span>
    <span class="vi">@alpha = </span><span class="mf">0.3</span>
    <span class="vi">@color = </span><span class="nx">color</span> <span class="o">or</span> <span class="k">new</span> <span class="nx">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nx">@setExtent</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
  
  </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>this.updateRendering();</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">autoOrientation: </span><span class="nf">-&gt;</span>
      <span class="nx">noOperation</span>
  
  <span class="nv">rangeSize: </span><span class="nf">-&gt;</span>
    <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@start</span>
  
  <span class="nv">ratio: </span><span class="nf">-&gt;</span>
    <span class="nx">@size</span> <span class="o">/</span> <span class="nx">@rangeSize</span><span class="p">()</span>
  
  <span class="nv">unitSize: </span><span class="nf">-&gt;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">@height</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@button</span><span class="p">.</span><span class="nx">height</span><span class="p">())</span> <span class="o">/</span> <span class="nx">@rangeSize</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">@orientation</span> <span class="o">is</span> <span class="s">&quot;vertical&quot;</span>
    <span class="p">(</span><span class="nx">@width</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@button</span><span class="p">.</span><span class="nx">width</span><span class="p">())</span> <span class="o">/</span> <span class="nx">@rangeSize</span><span class="p">()</span>
  
  <span class="nv">updateRendering: </span><span class="nf">-&gt;</span>
    <span class="k">super</span><span class="p">()</span>
    <span class="vi">@button.orientation = </span><span class="nx">@orientation</span>
    <span class="k">if</span> <span class="nx">@orientation</span> <span class="o">is</span> <span class="s">&quot;vertical&quot;</span>
      <span class="nv">bw = </span><span class="nx">@width</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span>
      <span class="nv">bh = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">bw</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">@height</span><span class="p">()</span> <span class="o">*</span> <span class="nx">@ratio</span><span class="p">()))</span>
      <span class="nx">@button</span><span class="p">.</span><span class="nx">silentSetExtent</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">(</span><span class="nx">bw</span><span class="p">,</span> <span class="nx">bh</span><span class="p">)</span>
      <span class="nv">posX = </span><span class="mi">1</span>
      <span class="nv">posY = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span>
        <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">@value</span> <span class="o">-</span> <span class="nx">@start</span><span class="p">)</span> <span class="o">*</span> <span class="nx">@unitSize</span><span class="p">()),</span>
        <span class="nx">@height</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@button</span><span class="p">.</span><span class="nx">height</span><span class="p">())</span>
    <span class="k">else</span>
      <span class="nv">bh = </span><span class="nx">@height</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span>
      <span class="nv">bw = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">bh</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">@width</span><span class="p">()</span> <span class="o">*</span> <span class="nx">@ratio</span><span class="p">()))</span>
      <span class="nx">@button</span><span class="p">.</span><span class="nx">silentSetExtent</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">(</span><span class="nx">bw</span><span class="p">,</span> <span class="nx">bh</span><span class="p">)</span>
      <span class="nv">posY = </span><span class="mi">1</span>
      <span class="nv">posX = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span>
        <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">@value</span> <span class="o">-</span> <span class="nx">@start</span><span class="p">)</span> <span class="o">*</span> <span class="nx">@unitSize</span><span class="p">()),</span>
        <span class="nx">@width</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@button</span><span class="p">.</span><span class="nx">width</span><span class="p">())</span>
    <span class="nx">@button</span><span class="p">.</span><span class="nx">setPosition</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">(</span><span class="nx">posX</span><span class="p">,</span> <span class="nx">posY</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">@bounds</span><span class="p">.</span><span class="nx">origin</span><span class="p">)</span>
    <span class="nx">@button</span><span class="p">.</span><span class="nx">updateRendering</span><span class="p">()</span>
    <span class="nx">@button</span><span class="p">.</span><span class="nx">changed</span><span class="p">()</span>
  
  <span class="nv">updateValue: </span><span class="nf">-&gt;</span>
    <span class="k">if</span> <span class="nx">@orientation</span> <span class="o">is</span> <span class="s">&quot;vertical&quot;</span>
      <span class="nv">relPos = </span><span class="nx">@button</span><span class="p">.</span><span class="nx">top</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@top</span><span class="p">()</span>
    <span class="k">else</span>
      <span class="nv">relPos = </span><span class="nx">@button</span><span class="p">.</span><span class="nx">left</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@left</span><span class="p">()</span>
    <span class="vi">@value = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">relPos</span> <span class="o">/</span> <span class="nx">@unitSize</span><span class="p">()</span> <span class="o">+</span> <span class="nx">@start</span><span class="p">)</span>
    <span class="nx">@updateTarget</span><span class="p">()</span>
  
  <span class="nv">updateTarget: </span><span class="nf">-&gt;</span>
    <span class="k">if</span> <span class="nx">@action</span>
      <span class="k">if</span> <span class="k">typeof</span> <span class="nx">@action</span> <span class="o">is</span> <span class="s">&quot;function&quot;</span>
        <span class="nx">@action</span><span class="p">.</span><span class="nx">call</span> <span class="nx">@target</span><span class="p">,</span> <span class="nx">@value</span>
      <span class="k">else</span> <span class="c1"># assume it&#39;s a String</span>
        <span class="nx">@target</span><span class="p">[</span><span class="nx">@action</span><span class="p">]</span> <span class="nx">@value</span>
  
  </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>SliderMorph duplicating:</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">copyRecordingReferences: </span><span class="nf">(dict) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>inherited, see comment in Morph</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">c = </span><span class="k">super</span> <span class="nx">dict</span>
    <span class="nv">c.target = </span><span class="p">(</span><span class="nx">dict</span><span class="p">[</span><span class="nx">@target</span><span class="p">])</span>  <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">target</span> <span class="o">and</span> <span class="nx">dict</span><span class="p">[</span><span class="nx">@target</span><span class="p">]</span>
    <span class="nv">c.button = </span><span class="p">(</span><span class="nx">dict</span><span class="p">[</span><span class="nx">@button</span><span class="p">])</span>  <span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">button</span> <span class="o">and</span> <span class="nx">dict</span><span class="p">[</span><span class="nx">@button</span><span class="p">]</span>
    <span class="nx">c</span>
  
  </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>SliderMorph menu:</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">developersMenu: </span><span class="nf">-&gt;</span>
    <span class="nv">menu = </span><span class="k">super</span><span class="p">()</span>
    <span class="nx">menu</span><span class="p">.</span><span class="nx">addItem</span> <span class="s">&quot;show value...&quot;</span><span class="p">,</span> <span class="s">&quot;showValue&quot;</span><span class="p">,</span> <span class="s">&quot;display a dialog box\nshowing the selected number&quot;</span>
    <span class="nx">menu</span><span class="p">.</span><span class="nx">addItem</span> <span class="s">&quot;floor...&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nf">-&gt;</span>
      <span class="nx">@prompt</span> <span class="nx">menu</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s">&quot;\nfloor:&quot;</span><span class="p">,</span>
        <span class="nx">@setStart</span><span class="p">,</span>
        <span class="nx">@</span><span class="p">,</span>
        <span class="nx">@start</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
        <span class="kc">null</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@size</span><span class="p">,</span>
        <span class="kc">true</span>
    <span class="p">),</span> <span class="s">&quot;set the minimum value\nwhich can be selected&quot;</span>
    <span class="nx">menu</span><span class="p">.</span><span class="nx">addItem</span> <span class="s">&quot;ceiling...&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nf">-&gt;</span>
      <span class="nx">@prompt</span> <span class="nx">menu</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s">&quot;\nceiling:&quot;</span><span class="p">,</span>
        <span class="nx">@setStop</span><span class="p">,</span>
        <span class="nx">@</span><span class="p">,</span>
        <span class="nx">@stop</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
        <span class="kc">null</span><span class="p">,</span>
        <span class="nx">@start</span> <span class="o">+</span> <span class="nx">@size</span><span class="p">,</span>
        <span class="nx">@size</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
        <span class="kc">true</span>
    <span class="p">),</span> <span class="s">&quot;set the maximum value\nwhich can be selected&quot;</span>
    <span class="nx">menu</span><span class="p">.</span><span class="nx">addItem</span> <span class="s">&quot;button size...&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nf">-&gt;</span>
      <span class="nx">@prompt</span> <span class="nx">menu</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="s">&quot;\nbutton size:&quot;</span><span class="p">,</span>
        <span class="nx">@setSize</span><span class="p">,</span>
        <span class="nx">@</span><span class="p">,</span>
        <span class="nx">@size</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
        <span class="kc">null</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@start</span><span class="p">,</span>
        <span class="kc">true</span>
    <span class="p">),</span> <span class="s">&quot;set the range\ncovered by\nthe slider button&quot;</span>
    <span class="nx">menu</span><span class="p">.</span><span class="nx">addLine</span><span class="p">()</span>
    <span class="nx">menu</span><span class="p">.</span><span class="nx">addItem</span> <span class="s">&quot;set target&quot;</span><span class="p">,</span> <span class="s">&quot;setTarget&quot;</span><span class="p">,</span> <span class="s">&quot;select another morph\nwhose numerical property\nwill be &quot;</span> <span class="o">+</span> <span class="s">&quot;controlled by this one&quot;</span>
    <span class="nx">menu</span>
  
  <span class="nv">showValue: </span><span class="nf">-&gt;</span>
    <span class="nx">@inform</span> <span class="nx">@value</span>
  
  <span class="nv">userSetStart: </span><span class="nf">(num) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>for context menu demo purposes</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@start = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">num</span><span class="p">,</span> <span class="nx">@stop</span><span class="p">)</span>
  
  <span class="nv">setStart: </span><span class="nf">(num) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>for context menu demo purposes</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">num</span> <span class="o">is</span> <span class="s">&quot;number&quot;</span>
      <span class="vi">@start = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">num</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@size</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nv">newStart = </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span>
      <span class="vi">@start = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">newStart</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@size</span><span class="p">)</span>  <span class="k">unless</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">newStart</span><span class="p">)</span>
    <span class="vi">@value = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">@value</span><span class="p">,</span> <span class="nx">@start</span><span class="p">)</span>
    <span class="nx">@updateTarget</span><span class="p">()</span>
    <span class="nx">@updateRendering</span><span class="p">()</span>
    <span class="nx">@changed</span><span class="p">()</span>
  
  <span class="nv">setStop: </span><span class="nf">(num) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>for context menu demo purposes</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">num</span> <span class="o">is</span> <span class="s">&quot;number&quot;</span>
      <span class="vi">@stop = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">num</span><span class="p">,</span> <span class="nx">@start</span> <span class="o">+</span> <span class="nx">@size</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nv">newStop = </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span>
      <span class="vi">@stop = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">newStop</span><span class="p">,</span> <span class="nx">@start</span> <span class="o">+</span> <span class="nx">@size</span><span class="p">)</span>  <span class="k">unless</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">newStop</span><span class="p">)</span>
    <span class="vi">@value = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">@value</span><span class="p">,</span> <span class="nx">@stop</span><span class="p">)</span>
    <span class="nx">@updateTarget</span><span class="p">()</span>
    <span class="nx">@updateRendering</span><span class="p">()</span>
    <span class="nx">@changed</span><span class="p">()</span>
  
  <span class="nv">setSize: </span><span class="nf">(num) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>for context menu demo purposes</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">num</span> <span class="o">is</span> <span class="s">&quot;number&quot;</span>
      <span class="vi">@size = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@start</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nv">newSize = </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span>
      <span class="vi">@size = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">newSize</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@start</span><span class="p">)</span>  <span class="k">unless</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">newSize</span><span class="p">)</span>
    <span class="vi">@value = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">@value</span><span class="p">,</span> <span class="nx">@stop</span> <span class="o">-</span> <span class="nx">@size</span><span class="p">)</span>
    <span class="nx">@updateTarget</span><span class="p">()</span>
    <span class="nx">@updateRendering</span><span class="p">()</span>
    <span class="nx">@changed</span><span class="p">()</span>
  
  <span class="nv">setTarget: </span><span class="nf">-&gt;</span>
    <span class="nv">choices = </span><span class="nx">@overlappedMorphs</span><span class="p">()</span>
    <span class="nv">menu = </span><span class="k">new</span> <span class="nx">MenuMorph</span><span class="p">(</span><span class="nx">@</span><span class="p">,</span> <span class="s">&quot;choose target:&quot;</span><span class="p">)</span>
    <span class="nx">choices</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@world</span><span class="p">()</span>
    <span class="nx">choices</span><span class="p">.</span><span class="nx">forEach</span> <span class="nf">(each) =&gt;</span>
      <span class="nx">menu</span><span class="p">.</span><span class="nx">addItem</span> <span class="nx">each</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="o">=&gt;</span>
        <span class="vi">@target = </span><span class="nx">each</span>
        <span class="nx">@setTargetSetter</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">choices</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
      <span class="vi">@target = </span><span class="nx">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="nx">@setTargetSetter</span><span class="p">()</span>
    <span class="k">else</span> <span class="nx">menu</span><span class="p">.</span><span class="nx">popUpAtHand</span> <span class="nx">@world</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">choices</span><span class="p">.</span><span class="nx">length</span>
  
  <span class="nv">setTargetSetter: </span><span class="nf">-&gt;</span>
    <span class="nv">choices = </span><span class="nx">@target</span><span class="p">.</span><span class="nx">numericalSetters</span><span class="p">()</span>
    <span class="nv">menu = </span><span class="k">new</span> <span class="nx">MenuMorph</span><span class="p">(</span><span class="nx">@</span><span class="p">,</span> <span class="s">&quot;choose target property:&quot;</span><span class="p">)</span>
    <span class="nx">choices</span><span class="p">.</span><span class="nx">forEach</span> <span class="nf">(each) =&gt;</span>
      <span class="nx">menu</span><span class="p">.</span><span class="nx">addItem</span> <span class="nx">each</span><span class="p">,</span> <span class="o">=&gt;</span>
        <span class="vi">@action = </span><span class="nx">each</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="nx">choices</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
      <span class="vi">@action = </span><span class="nx">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span> <span class="nx">menu</span><span class="p">.</span><span class="nx">popUpAtHand</span> <span class="nx">@world</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">choices</span><span class="p">.</span><span class="nx">length</span>
  
  <span class="nv">numericalSetters: </span><span class="nf">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>for context menu demo purposes</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">list = </span><span class="k">super</span><span class="p">()</span>
    <span class="nx">list</span><span class="p">.</span><span class="nx">push</span> <span class="s">&quot;setStart&quot;</span><span class="p">,</span> <span class="s">&quot;setStop&quot;</span><span class="p">,</span> <span class="s">&quot;setSize&quot;</span>
    <span class="nx">list</span>
  
  </pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>SliderMorph stepping:</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">mouseDownLeft: </span><span class="nf">(pos) -&gt;</span>
    <span class="k">unless</span> <span class="nx">@button</span><span class="p">.</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">containsPoint</span><span class="p">(</span><span class="nx">pos</span><span class="p">)</span>
      <span class="vi">@offset = </span><span class="k">new</span> <span class="nx">Point</span><span class="p">()</span> <span class="c1"># return null;</span>
    <span class="k">else</span>
      <span class="vi">@offset = </span><span class="nx">pos</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="nx">@button</span><span class="p">.</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">origin</span><span class="p">)</span>
    <span class="nv">world = </span><span class="nx">@root</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>this is to create the "drag the slider" effect
basically if the mouse is pressing within the boundaries
then in the next step you remember to check again where the mouse
is and update the scrollbar. As soon as the mouse is unpressed
then the step function is set to null to save cycles.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@step = </span><span class="o">=&gt;</span>
      <span class="k">if</span> <span class="nx">world</span><span class="p">.</span><span class="nx">hand</span><span class="p">.</span><span class="nx">mouseButton</span>
        <span class="nv">mousePos = </span><span class="nx">world</span><span class="p">.</span><span class="nx">hand</span><span class="p">.</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">origin</span>
        <span class="k">if</span> <span class="nx">@orientation</span> <span class="o">is</span> <span class="s">&quot;vertical&quot;</span>
          <span class="nv">newX = </span><span class="nx">@button</span><span class="p">.</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">origin</span><span class="p">.</span><span class="nx">x</span>
          <span class="nv">newY = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span>
            <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">mousePos</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">@offset</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span>
            <span class="nx">@bottom</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@button</span><span class="p">.</span><span class="nx">height</span><span class="p">()),</span> <span class="nx">@top</span><span class="p">())</span>
        <span class="k">else</span>
          <span class="nv">newY = </span><span class="nx">@button</span><span class="p">.</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">origin</span><span class="p">.</span><span class="nx">y</span>
          <span class="nv">newX = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span>
            <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">mousePos</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">@offset</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
            <span class="nx">@right</span><span class="p">()</span> <span class="o">-</span> <span class="nx">@button</span><span class="p">.</span><span class="nx">width</span><span class="p">()),</span> <span class="nx">@left</span><span class="p">())</span>
        <span class="nx">@button</span><span class="p">.</span><span class="nx">setPosition</span> <span class="k">new</span> <span class="nx">Point</span><span class="p">(</span><span class="nx">newX</span><span class="p">,</span> <span class="nx">newY</span><span class="p">)</span>
        <span class="nx">@updateValue</span><span class="p">()</span>
      <span class="k">else</span>
        <span class="vi">@step = </span><span class="kc">null</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 